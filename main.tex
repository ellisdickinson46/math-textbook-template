%
% Elliott Hudson College - Maths Booklet Template
% Created by: Ellis Dickinson
% Originally created on: May 3rd 2021
%
% IMPORTANT!!!!
% When compiling this document, please use XeLaTeX
% Other compilers do not support some of the features within this document.
%
\documentclass[fleqn]{article}
\usepackage[dvipsnames]{xcolor}
\usepackage[a4paper, portrait, margin=1.9cm]{geometry}
\usepackage{titlesec}
\usepackage{tikz}\usetikzlibrary{shapes.misc}\usetikzlibrary{calc}
\usepackage{setspace}
\usepackage{fontspec}
\usepackage[most]{tcolorbox}
\usepackage{varwidth}
\usepackage[inline]{enumitem}
\usepackage{multicol}
\usepackage{fancyhdr}
\usepackage{booktabs, tabularx}
\usepackage{mathtools}
\usepackage{tasks}
\usepackage{anyfontsize}
\usepackage[export]{adjustbox}		% http://ctan.org/pkg/adjustbox




\newcounter{taskscounter}
\settasks{							% Multi-column enumeration
	style=enumerate,
	counter=taskscounter,
	label-width={22pt},
	item-indent={15pt},
	label-align=right,
	label=\textbf{\alph*},
	before-skip = -\parskip , 		% undo paragraph skip
  	after-skip = -\parskip , 		% undo paragraph skip
  	after-item-skip = -\parskip+1mm	% undo paragraph skip
%   debug=true 						% useful for fine-tuning or debugging
}



% Define dynamic titlebars for sections/exercises
\newlength{\sectionnumberwidth}
\newcommand\titlebar{\hspace*{-0.1cm}
	\tikz[baseline, trim right=3.1cm] {
		\settowidth{\sectionnumberwidth}{
			\pgfinterruptpicture
				\textbf{\sffamily\thesection.\thesubsection}
			\endpgfinterruptpicture
		}
	    \fill [cyan!25, rounded corners=0.15cm] (2.5cm,-1.28ex) rectangle (\textwidth-\sectionnumberwidth+2.65cm,2.615ex);
	    \node [
	        fill=blue!60!white,
	        text=white,
	        anchor= base east,
	        rounded rectangle,
	        inner sep = 2mm,
	        minimum height=3.89ex] at (3cm,0) {
	        {\bfseries\thesection.\thesubsection}
	    };
	}
}
\newcommand\exercisebar{\hspace*{-0.1cm}
	\tikz[baseline, trim right=3.1cm] {
		\settowidth{\sectionnumberwidth}{
			\pgfinterruptpicture
				\textbf{\sffamily\thesection.\thesubsubsection}
			\endpgfinterruptpicture
		}
	    \fill [red!25, rounded corners=0.15cm] (2.5cm,-1.265ex) rectangle (\textwidth-\sectionnumberwidth+2.65cm,2.64ex);
	    \node [
	        fill=cherryred!80!white,
	        text=white,
	        anchor= base east,
	        rounded rectangle,
	        inner sep = 2mm,
	        minimum height=3.9ex] at (3cm,0) {
	        {\bfseries\thesection\thesubsubsection}
	    };
	}
}

\newtcolorbox{mybox2}[2][]{
	enhanced,
	before skip=2mm,after skip=2mm,
	colback=black!5,
	colframe=black!50,
	boxrule=0.2mm,
	attach boxed title to top left={
		xshift=1cm,yshift*=1mm-\tcboxedtitleheight},
		varwidth boxed title*=-3cm,
		boxed title style={frame code={
            \path[fill=tcbcolback!30!black]
              ([yshift=-1mm,xshift=-1mm]frame.north west)
                arc[start angle=0,end angle=180,radius=1mm]
              ([yshift=-1mm,xshift=1mm]frame.north east)
                arc[start angle=180,end angle=0,radius=1mm];
            \path[left color=tcbcolback!60!black,right color=tcbcolback!60!black,
              middle color=tcbcolback!80!black]
              ([xshift=-2mm]frame.north west) -- ([xshift=2mm]frame.north east)
              [rounded corners=1mm]-- ([xshift=1mm,yshift=-1mm]frame.north east)
              -- (frame.south east) -- (frame.south west)
              -- ([xshift=-1mm,yshift=-1mm]frame.north west)
              [sharp corners]-- cycle;
            },interior engine=empty,
          },
	fonttitle=\sffamily\bfseries,
    title={#2},
    before upper = \sffamily,
    #1
}
          
\tcbset{%
    example/.style={%
        enhanced,
        breakable,
        rounded corners,
        toprule=0pt, rightrule=0pt, bottomrule=0pt, leftrule=1mm,
        colback=#1!5, colframe=#1!80!black, coltitle=#1!80!black,
        fonttitle=\bfseries\large\sffamily,
        detach title,
        before upper={\tcbtitle\quad},
        fontupper=\linespread{1.2}\selectfont
    },
    note/.style={%
        enhanced,
        breakable,
        separator sign none,
        rounded corners,
        toprule=0pt, rightrule=0pt, bottomrule=0pt, leftrule=1mm,
        colback=#1!5, colframe=#1!80!black, coltitle=#1!80!black,
        fonttitle=\bfseries\large,
        detach title,
        before upper={\sffamily\tcbtitle\quad\hspace{-2mm}},
        fontupper=\linespread{1.2}\selectfont
    }
}
\newtcbtheorem[auto counter]{examplebox}{Example}
{example=blue}{ex}
\newtcbtheorem{practice}{Independent Practice}
{example=practiceorange}{pr}
\newtcbtheorem{note}{#1\hspace{-1mm}}
{note=notecolor}{nt}



% Custom Colour Definitions
\definecolor{practiceorange}{RGB}{252, 191, 0}
\definecolor{notecolor}{RGB}{0, 0, 0}
\definecolor{ehclogoblue}{RGB}{82, 184, 208}
\definecolor{cherryred}{RGB}{191,0,0}



\setstretch{1.1} 										% Globally adjust bullet spacing
\setlength{\parindent}{0cm} 								% Removes paragraph indent
\setlength{\multicolsep}{6.0pt plus 2.0pt minus 1.5pt}	% Halves whitespace before multicol environment
\setlength\tabcolsep{0pt} 								% Removes default space between columns in table



\setsansfont{AptiferSansPro}[
	Path = fonts/,
	Extension = .ttf,
    UprightFont = *-Regular,
    BoldFont = *-Medium
]



% Implement the custom titlebars
\titleformat{\section}{\large\sffamily}{\titlebar}{0.1cm}{}
\titleformat{\subsection}{\large\sffamily}{\titlebar}{0.1cm}{}
\titleformat{\subsubsection}{\large\sffamily}{\exercisebar}{0.1cm}{}



% Define the easier get functions for sections and subsections
\renewcommand*{\thesection}{\arabic{section}}
\renewcommand*{\thesubsection}{\arabic{subsection}}
\renewcommand*{\thesubsubsection}{\Alph{subsubsection}}
\newcommand\getcurrentref[1]{%
 \ifnumequal{\value{#1}}{0}
  {??}
  {\the\value{#1}}%
}
\newcommand{\exercise}{\subsubsection}
\setitemize{itemsep=2pt}



%Custom font size 'YUGE', larger than huge
\newcommand\YUGE{\fontsize{35}{35}\selectfont}

% Define custom footer
\fancypagestyle{plain}{
	\fancyhf{} % clear all header and footer fields
	\fancyfoot[C]{\sffamily\fontsize{9pt}{9pt}\selectfont\formattedunittitle{ -- }\bookletunittitle { -- }Page \thepage} % except the center
	\renewcommand{\headrulewidth}{0pt}
	\renewcommand{\footrulewidth}{0pt}
}
\pagestyle{plain}



% Function for adding vspace above underbrace
\newcommand*\addunderbracespace[1]{\vrule width0pt height0pt depth#1\relax}


% TODO Define Document Info Here
% Set section (aka. Unit Number - without letter)
\setcounter{section}{1} 												% Set the Unit Number (without Leading 0's)
\newcommand{\coursetitle}{AS Pure Mathematics (Year 1)}				% Set the Course Title
\newcommand{\bookletunittitle}{Algebraic expressions}				% Set the Unit Title
\newcommand{\bookletsubtitle}{{\rmfamily\LaTeX} Template created by: Ellis Dickinson}	% Set the Subtitle
%\newcommand{\bookletsubtitle}{Last revised by: J Sherwood, May 3rd 2021}	% Set the Subtitle
\newcommand{\formattedunittitle}{Unit P\getcurrentref{section}} 		% DO NOT CHANGE ME!!!!!!











% TODO Document Begins
\begin{document}

\input{components/titlepage}
\vfill
\input{components/keyinformation}

\newpage



% TODO Links to the Big Picture
\begin{mybox2}[colbacktitle=WildStrawberry]{Links to the Big Picture}
	\begin{enumerate}[label*=P\arabic*., leftmargin=*]
		\setlength{\itemsep}{-2pt}%
		\setcounter{enumi}{\getcurrentref{section}-1}
	 	\item \textbf{\bookletunittitle} \vspace{-2mm}
	 	\begin{enumerate}[label*=\arabic*]
		 	\setlength{\itemsep}{0pt}%
		    \item Index Laws
		    \item Expanding Brackets
		    \item Factorising
		    \item Negative and fractional indices
		    \item Surds
			\item Rationalising Denominators
	 	\end{enumerate}
	\end{enumerate}
    \begin{tabularx}{\dimexpr\textwidth}{X@{\hskip6pt}X}
	    {\sffamily
		    Develops:
		    \vspace{-2mm}
			\begin{itemize}
				\setlength{\itemsep}{-2pt}%
				\item GCSE algebraic manipulation
			\end{itemize}
		} & {\sffamily
			Leads to:
			\vspace{-2mm}
			\begin{itemize}
				\setlength{\itemsep}{-2pt}%
				\item P2 -- Quadratics
				\item P6 -- Algebraic Methods
				\item P9 -- Integration
				\item P12 -- Differentiation
				\item P13 -- Integration
			\end{itemize}
		}
	\end{tabularx}
    \vspace{-4mm}
\end{mybox2}
\begin{note*}{Exam Question}{}
	\rmfamily
	\begin{enumerate}[label=\textbf{\alph*}]
		\item Write	$\sqrt{45}$ in the form $a\sqrt{5}$, where $a$ is an integer.\hfill\textbf{(1 mark)}
		\item Express $\cfrac{2(3+\sqrt{5})}{(3-\sqrt{5})}$ in the form $b+c\sqrt{5}$, where $b$ and $c$ are integers. \hfill\textbf{(5 marks)}
	\end{enumerate}

\end{note*}

\subsubsection{}
$x^{\tfrac{1}{2}}$



\end{document}